{% extends "base.html" %}

{% block title %}View Employee - CRM System{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{{ url_for('dashboard.index') }}">Dashboard</a></li>
<li class="breadcrumb-item"><a href="{{ url_for('employees.index') }}">Employees</a></li>
<li class="breadcrumb-item active">View Employee</li>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>
                <i class="bi bi-eye text-primary"></i>
                View Employee
            </h2>
            <div>
                <a href="{{ url_for('employees.edit', id=employee.id) }}" class="btn btn-secondary me-2">
                    <i class="bi bi-pencil"></i> Edit
                </a>
                <a href="{{ url_for('employees.index') }}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left"></i> Back to Employees
                </a>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Employee Details</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <dl class="row">
                            <dt class="col-sm-5">Employee Code:</dt>
                            <dd class="col-sm-7">{{ employee.employee_code }}</dd>

                            <dt class="col-sm-5">Name:</dt>
                            <dd class="col-sm-7">{{ employee.name }}</dd>

                            <dt class="col-sm-5">Contact:</dt>
                            <dd class="col-sm-7">{{ employee.contact_no }}</dd>

                            <dt class="col-sm-5">Email:</dt>
                            <dd class="col-sm-7">{{ employee.email or '-' }}</dd>

                            <dt class="col-sm-5">Designation:</dt>
                            <dd class="col-sm-7">{{ employee.designation or '-' }}</dd>

                            <dt class="col-sm-5">Employment Type:</dt>
                            <dd class="col-sm-7">{{ employee.employ_type or '-' }}</dd>
                        </dl>
                    </div>
                    <div class="col-md-6">
                        <dl class="row">
                            <dt class="col-sm-5">Gender:</dt>
                            <dd class="col-sm-7">{{ employee.gender if employee.gender else '-' }}</dd>

                            <dt class="col-sm-5">Date of Birth:</dt>
                            <dd class="col-sm-7">{{ employee.dob.strftime('%d/%m/%Y') if employee.dob else '-' }}</dd>

                            <dt class="col-sm-5">Degree:</dt>
                            <dd class="col-sm-7">{{ employee.degree or '-' }}</dd>

                            <dt class="col-sm-5">Total Experience:</dt>
                            <dd class="col-sm-7">{{ employee.total_experience or '-' }}</dd>

                            <dt class="col-sm-5">WhatsApp:</dt>
                            <dd class="col-sm-7">{{ employee.whatsapp_no or '-' }}</dd>

                            <dt class="col-sm-5">Aadhar:</dt>
                            <dd class="col-sm-7">{{ employee.aadhar_no or '-' }}</dd>
                        </dl>
                    </div>
                </div>

                <!-- Banking Information -->
                {% if employee.bank_name or employee.account_no %}
                <div class="mt-3">
                    <h6>Banking Information:</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <dl class="row">
                                <dt class="col-sm-5">Bank Name:</dt>
                                <dd class="col-sm-7">{{ employee.bank_name or '-' }}</dd>

                                <dt class="col-sm-5">Branch:</dt>
                                <dd class="col-sm-7">{{ employee.branch_name or '-' }}</dd>
                            </dl>
                        </div>
                        <div class="col-md-6">
                            <dl class="row">
                                <dt class="col-sm-5">Account No:</dt>
                                <dd class="col-sm-7">{{ employee.account_no or '-' }}</dd>

                                <dt class="col-sm-5">IFSC Code:</dt>
                                <dd class="col-sm-7">{{ employee.ifsc_code or '-' }}</dd>
                            </dl>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Address Information -->
                {% if employee.temporary_address or employee.permanent_address %}
                <div class="mt-3">
                    <h6>Address Information:</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <strong>Temporary Address:</strong>
                            <p>{{ employee.temporary_address or '-' }}</p>
                        </div>
                        <div class="col-md-6">
                            <strong>Permanent Address:</strong>
                            <p>{{ employee.permanent_address or '-' }}</p>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Skills and Additional Info -->
                {% if employee.skill_set or employee.pdf_link or employee.employ_image %}
                <div class="mt-3">
                    <h6>Additional Information:</h6>
                    {% if employee.skill_set %}
                    <p><strong>Skill Set:</strong> {{ employee.skill_set }}</p>
                    {% endif %}
                    {% if employee.pdf_link %}
                    <p><strong>PDF:</strong>
                        {% if employee.pdf_link.startswith('uploads/') %}
                            <a href="{{ url_for('static', filename=employee.pdf_link) }}" target="_blank">View PDF</a>
                        {% else %}
                            <a href="{{ employee.pdf_link }}" target="_blank">{{ employee.pdf_link }}</a>
                        {% endif %}
                    </p>
                    {% endif %}
                    {% if employee.employ_image %}
                    <p><strong>Employee Image:</strong>
                        {% if employee.employ_image.startswith('uploads/') %}
                            <br><img src="{{ url_for('static', filename=employee.employ_image) }}" alt="Employee Image" class="img-thumbnail" style="max-width: 200px;">
                        {% else %}
                            <br><img src="{{ employee.employ_image }}" alt="Employee Image" class="img-thumbnail" style="max-width: 200px;">
                        {% endif %}
                    </p>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">Actions</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <a href="{{ url_for('employees.edit', id=employee.id) }}" class="btn btn-secondary">
                        <i class="bi bi-pencil"></i> Edit Employee
                    </a>
                </div>
            </div>
        </div>

        <!-- Bookings section removed - would require separate query to load relationships -->
    </div>
</div>
{% endblock %}